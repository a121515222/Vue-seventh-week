(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b893791"],{"2a53":function(e,t,n){"use strict";var o=n("7a23"),a={"aria-label":"Page navigation example"},c={class:"pagination"},l=Object(o["createElementVNode"])("span",{"aria-hidden":"true"},"«",-1),i=[l],s=["onClick"],d=Object(o["createElementVNode"])("span",{"aria-hidden":"true"},"»",-1),r=[d];function u(e,t,n,l,d,u){return Object(o["openBlock"])(),Object(o["createElementBlock"])("nav",a,[Object(o["createElementVNode"])("ul",c,[Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])(["page-item",{disabled:!n.pagination.has_pre}])},[Object(o["createElementVNode"])("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=Object(o["withModifiers"])((function(t){return e.$emit("sendPage",n.pagination.current_page-1)}),["prevent"]))},i)],2),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(n.pagination.total_pages,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:Object(o["normalizeClass"])(["page-item",{active:t===n.pagination.current_page}]),key:t+"page"},[Object(o["createElementVNode"])("a",{class:"page-link",href:"#",onClick:Object(o["withModifiers"])((function(n){return e.$emit("sendPage",t)}),["prevent"])},Object(o["toDisplayString"])(t),9,s)],2)})),128)),Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])(["page-item",{disabled:!n.pagination.has_next}])},[Object(o["createElementVNode"])("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=Object(o["withModifiers"])((function(t){return e.$emit("sendPage",n.pagination.current_page+1)}),["prevent"]))},r)],2)])])}var p={props:["pagination"],emit:["sendPage"]},b=n("d959"),m=n.n(b);const h=m()(p,[["render",u]]);t["a"]=h},"6efc":function(e,t,n){"use strict";n.r(t);var o=n("7a23"),a={class:"container"},c={class:"row py-5"},l=Object(o["createElementVNode"])("h2",null,"優惠券列表",-1),i={class:"d-flex justify-content-end"},s={class:"col-12 py-3"},d={class:"border rounded"},r={class:"table table-hover"},u=Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"名稱"),Object(o["createElementVNode"])("th",null,"折扣幅度"),Object(o["createElementVNode"])("th",null,"使用期限"),Object(o["createElementVNode"])("th",null,"優惠碼"),Object(o["createElementVNode"])("th",null,"是否啟用"),Object(o["createElementVNode"])("th"),Object(o["createElementVNode"])("th")],-1),p=["data-index","onClick"],b={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},m=Object(o["createTextVNode"])(" 編輯 "),h=["onClick"],O={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},j=Object(o["createTextVNode"])(" 刪除 "),f={class:"px-1"};function g(e,t,n,g,N,v){var E=Object(o["resolveComponent"])("VueLoading"),V=Object(o["resolveComponent"])("PaginationComponent"),C=Object(o["resolveComponent"])("AdminCouponModal");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("div",a,[Object(o["createVNode"])(E,{active:N.isLoading,"z-index":1060},null,8,["active"]),Object(o["createElementVNode"])("div",c,[l,Object(o["createElementVNode"])("div",i,[Object(o["createElementVNode"])("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=function(e){N.isNew=!0,v.openModal()})}," 增加優惠券 ")]),Object(o["createElementVNode"])("div",s,[Object(o["createElementVNode"])("div",d,[Object(o["createElementVNode"])("table",r,[u,(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(N.coupons,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:e.id+t},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.title),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.percent),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(v.showTime(0|e.due_date)),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.code),1),Object(o["createElementVNode"])("td",{class:Object(o["normalizeClass"])({"text-success":1===e.is_enabled,"text-danger":0===e.is_enabled})},Object(o["toDisplayString"])(v.couponStatus(e.is_enabled)),3),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("button",{class:"btn btn-outline-success","data-index":t,type:"button",onClick:function(t){N.postId=e.id,N.isNew=!1,v.openModal(e)}},[N.isLoading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",b)):Object(o["createCommentVNode"])("",!0),m],8,p)]),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("button",{class:"btn btn-outline-danger",type:"button",onClick:function(n){N.postId=e.id,v.deleteCoupon(t)}},[N.isLoading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",O)):Object(o["createCommentVNode"])("",!0),j],8,h)])])})),128))]),Object(o["createElementVNode"])("p",f,"一共有"+Object(o["toDisplayString"])(N.coupons.length)+"項優惠券",1)]),Object(o["createVNode"])(V,{pagination:N.page,onSendPage:v.getCoupon},null,8,["pagination","onSendPage"])])])]),Object(o["createVNode"])(C,{ref:"myCouponModal","send-coupon":N.sendCoupon,"is-new":N.isNew,onSendCloseResetCouponData:t[1]||(t[1]=function(e){return v.resetCoupon()}),onSendCouponData:v.adminEditCoupon},null,8,["send-coupon","is-new","onSendCouponData"])],64)}var N=n("5530"),v=(n("99af"),n("0d03"),n("4160"),n("d3b7"),n("159b"),n("b64b"),n("2a53")),E={class:"modal fade",id:"modalCouponData",tabindex:"-1","aria-hidden":"true",ref:"theCouponModal"},V={class:"modal-dialog modal-xl"},C={class:"modal-content"},k={class:"modal-header"},w={class:"modal-title"},y={class:"modal-body"},D={class:"row"},x={class:"col-8 my-3 mx-auto"},M={class:"from-group my-3"},_=Object(o["createElementVNode"])("label",{class:"form-label w-100",for:"couponName"},"優惠券名稱",-1),S={class:"from-group my-3"},B=Object(o["createElementVNode"])("label",{class:"form-label w-100",for:"couponCode"},"折扣碼",-1),L={class:"d-flex gap-2"},$={class:"from-group my-3 w-50"},P=Object(o["createElementVNode"])("label",{class:"form-label w-100",for:"couponPercent"},"折扣幅度",-1),T={class:"from-group my-3 w-50"},I=Object(o["createElementVNode"])("label",{class:"form-label w-100",for:"couponDate"},"折扣到期日",-1),z={class:"d-flex gap-2"},J={class:"from-group my-3 w-50"},U=Object(o["createElementVNode"])("label",{for:"is_enabled",class:"form-label w-100"},"優惠卷啟用",-1),F={class:"modal-footer"};function A(e,t,n,a,c,l){var i=Object(o["resolveComponent"])("SwitchClick");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",E,[Object(o["createElementVNode"])("div",V,[Object(o["createElementVNode"])("div",C,[Object(o["createElementVNode"])("div",k,[Object(o["createElementVNode"])("h5",w,Object(o["toDisplayString"])(n.isNew?"新增優惠券":"編輯優惠券"),1),Object(o["createElementVNode"])("button",{class:"btn-close",type:"button",onClick:t[0]||(t[0]=function(e){return l.close()})})]),Object(o["createElementVNode"])("div",y,[Object(o["createElementVNode"])("div",D,[Object(o["createElementVNode"])("div",x,[Object(o["createElementVNode"])("div",M,[_,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control",type:"text",id:"couponName",placeholder:"請輸入優惠券名稱","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.couponData.title=e})},null,512),[[o["vModelText"],c.couponData.title,void 0,{trim:!0}]])]),Object(o["createElementVNode"])("div",S,[B,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control",type:"text",id:"couponCode",placeholder:"請輸入折扣碼","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.couponData.code=e})},null,512),[[o["vModelText"],c.couponData.code,void 0,{trim:!0}]])]),Object(o["createElementVNode"])("div",L,[Object(o["createElementVNode"])("div",$,[P,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control",type:"number",id:"couponPercent",placeholder:"請輸入折扣幅度,例如80為8折",max:"100","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.couponData.percent=e})},null,512),[[o["vModelText"],c.couponData.percent,void 0,{number:!0}]])]),Object(o["createElementVNode"])("div",T,[I,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control",type:"date",id:"couponDate",placeholder:"請選擇折扣到期日","onUpdate:modelValue":t[4]||(t[4]=function(e){return c.couponData.due_date=e})},null,512),[[o["vModelText"],c.couponData.due_date]])])]),Object(o["createElementVNode"])("div",z,[Object(o["createElementVNode"])("div",J,[U,Object(o["createVNode"])(i,{info:c.couponData.title,enabled:c.couponData.is_enabled,onSendEnable:l.getEnable},null,8,["info","enabled","onSendEnable"])])])])]),Object(o["createElementVNode"])("div",F,[Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-secondary",onClick:t[5]||(t[5]=function(e){return l.close()})}," 關閉 "),Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=function(e){return l.editCoupon()})}," 確定 ")])])])])],512)}n("ac1f"),n("1276"),n("accc"),n("e9c4");var R=n("7c2b"),q=n.n(R),G=n("803a"),H={props:["sendCoupon","isNew"],data:function(){return{couponData:{},bsModal:""}},components:{SwitchClick:G["a"]},emits:["send-coupon-data","send-close-resetCouponData"],methods:{getEnable:function(e){this.couponData.is_enabled=e},getTime:function(e){var t=new Date(1e3*e).toISOString().split("T");return t[0]},open:function(){this.bsModal.show()},close:function(){this.bsModal.hide(),this.$emit("send-close-resetCouponData")},editCoupon:function(){""!==this.couponData.title&&""!==this.couponData.code&&""!==this.couponData.due_date?this.$emit("send-coupon-data",this.couponData):alert("還有東西沒寫到")}},watch:{sendCoupon:{handler:function(e,t){this.couponData=JSON.parse(JSON.stringify(e)),this.couponData.due_date=this.getTime(this.couponData.due_date)},deep:!0}},mounted:function(){this.bsModal=new q.a(this.$refs.theCouponModal)}},K=n("d959"),Q=n.n(K);const W=Q()(H,[["render",A]]);var X=W,Y=n("1c55"),Z=n("be92"),ee=n("674f"),te={data:function(){return{coupons:[],isNew:!0,page:1,postId:"",sendCoupon:{title:"",is_enabled:null,percent:null,due_date:null,code:""},isLoading:!1}},components:{PaginationComponent:v["a"],AdminCouponModal:X},methods:Object(N["a"])(Object(N["a"])({},Object(Z["c"])(ee["a"],["addMessage"])),{},{deleteCoupon:function(e){var t=this;this.isLoading=!0;var n=confirm("將刪除'".concat(this.coupons[e].title,"''"));n&&this.$http["delete"]("".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("chun-chia","/admin/coupon/").concat(this.postId)).then((function(e){t.getCoupon(),t.isLoading=!1,t.addMessage({title:"刪除優惠券結果",style:"success",content:e.data.message})}))["catch"]((function(e){t.isLoading=!1,t.addMessage({title:"刪除優惠券結果",style:"danger",content:e.response.data.message})}))},couponStatus:function(e){return 0===e?"不啟用":"啟用"},adminEditCoupon:function(e){var t=this;this.isLoading=!0,e.due_date=Math.floor(new Date(e.due_date)/1e3);var n={data:e};!0===this.isNew?this.$http.post("".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("chun-chia","/admin/coupon"),n).then((function(e){t.getCoupon(),t.isLoading=!1,t.addMessage({title:"新增優惠券結果",style:"success",content:e.data.message}),t.closeModal()}))["catch"]((function(e){t.isLoading=!1,t.addMessage({title:"新增優惠券結果",style:"success",content:e.response.data.message})})):this.$http.put("".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("chun-chia","/admin/coupon/").concat(this.postId),n).then((function(e){alert(e.data.message),t.getCoupon(),t.closeModal(),t.isLoading=!1,t.addMessage({title:"編輯優惠券結果",style:"success",content:e.data.message})}))["catch"]((function(e){console.log(e.response.data.message),t.isLoading=!1,t.addMessage({title:"新增/編輯優惠券結果",style:"danger",content:e.response.data.message})}))},closeModal:function(){this.$refs.myCouponModal.close()},openModal:function(e){var t=this;this.$refs.myCouponModal.open(),!1===this.isNew&&(Object.keys(e).forEach((function(n){Object.keys(t.sendCoupon).forEach((function(o){n===o&&(t.sendCoupon[o]=e[n])}))})),this.postId=e.id)},resetCoupon:function(){this.sendCoupon.title="",this.sendCoupon.is_enabled=null,this.sendCoupon.percent=null,this.sendCoupon.due_date=null,this.sendCoupon.code=""},showTime:function(e){return Object(Y["a"])(e)},getCoupon:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0,this.$http.get("".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("chun-chia","/admin/coupons?page=").concat(t)).then((function(t){e.coupons=t.data.coupons,e.page=t.data.pagination,e.isLoading=!1}))["catch"]((function(t){console.dir(t.response.data.message),e.isLoading=!1}))}}),mounted:function(){this.getCoupon()}};const ne=Q()(te,[["render",g]]);t["default"]=ne},"803a":function(e,t,n){"use strict";var o=n("7a23"),a={class:"switch"},c=["id","checked"],l=["for"],i=Object(o["createElementVNode"])("span",{class:"switch-txt",turnOn:"是",turnOff:"否"},null,-1),s=Object(o["createElementVNode"])("span",{class:"switch-Round-btn"},null,-1),d=[i,s];function r(e,t,n,i,s,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",a,[Object(o["createElementVNode"])("input",{class:"switch-checkbox",type:"checkbox",name:"switch-checkbox",id:n.info||"tempID",checked:1===s.active,onClick:t[0]||(t[0]=function(t){r.activeChange(),e.$emit("send-enable",s.active)})},null,8,c),Object(o["createElementVNode"])("label",{class:"switch-label",for:n.info||"tempID"},d,8,l)])}var u={props:["info","enabled"],data:function(){return{active:0}},methods:{activeChange:function(){0===this.active?this.active=1:1===this.active&&(this.active=0)}},watch:{enabled:function(e){this.active=e}},mounted:function(){this.active=this.enabled||0}},p=(n("b665"),n("d959")),b=n.n(p);const m=b()(u,[["render",r]]);t["a"]=m},"82ca":function(e,t,n){},b665:function(e,t,n){"use strict";n("82ca")}}]);
//# sourceMappingURL=chunk-1b893791.caf8399a.js.map